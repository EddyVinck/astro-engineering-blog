---
import { getEntryBySlug } from "astro:content";

export interface Props {
  authorId: string;
}

const entry = await getEntryBySlug("author", Astro.props.authorId);
if (!entry) {
  throw new Error(`Author with id ${Astro.props.authorId} not found`);
}

const { Content } = await entry.render();
const { firstname, lastname, avatar, github, linkedin, twitter } = entry.data;
const socials = [
  { name: "Github", url: github },
  { name: "LinkedIn", url: linkedin },
  { name: "Twitter", url: twitter },
].filter((social) => social.url);
---

<div class="author">
  <h2>{firstname} {lastname}</h2>
  <img src={avatar} alt={`${firstname} ${lastname}`} />
  <div><Content /></div>
  {
    socials.length > 0 && (
      <>
        <p>My links</p>
        <ul>
          {socials.map((social) => (
            <li>
              <a href={social.url}>{social.name}</a>
            </li>
          ))}
        </ul>
      </>
    )
  }
</div>

<style>
  .author {
    display: flex;
    flex-direction: column;
    align-items: start;
    border: 2px solid #ccc;
    padding: 1rem;
    border-radius: 1rem;
  }
  .author img {
    width: 100px;
    height: 100px;
    border-radius: 50%;
  }
  .author ul {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    gap: 1rem;
  }
  p {
    margin-bottom: 0;
  }
</style>
